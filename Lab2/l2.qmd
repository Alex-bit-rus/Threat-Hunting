---
title: "Основы обработки данных с помощью R и Dplyr"
author: "alexkondrol@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель

1.  Развить практические навыки использования языка программирования R для обработки данных
2.  Закрепить знания базовых типов данных языка R
3.  Развить практические навыки использования функций обработки данных пакета `dplyr` – функции `select()`, `filter()`, `mutate()`, `arrange()`, `group_by()`

## Исходные данные

1.  Операционная система GNU/Linux, дистрибутив ALT
2.  Редактор кода Positron
3.  Интерпретатор R
4.  Пакет `dplyr` с встроенными функциями и набором данных `starwars`

## План

Проанализировать встроенный в пакет `dplyr` набор данных `starwars` с помощью языка R и ответить на вопросы.

## Описание шагов

### 1. Подключение пакета `dplyr`

Импортируем пакет `dplyr`, чтобы использовать набор данных `starwars` из него не обращаясь к нему каждый раз

```{r}
library("dplyr")
```

### 2. Базовое ознакомление с набором данных `starwars`

Для выведем датафрейм `starwars`:

```{r}
starwars
```

![](img/1.png){width="671"}

Как видно из изображение выше, в датафрейме `starwars` перечислены персонажи из франшизы "Звездные войны", а также сведения о них.

### Ответы на вопросы

#### 1. Сколько строк в датафрейме?

```{r}
starwars %>% nrow()
```


#### 2. Сколько столбцов в датафрейме?

```{r}
starwars %>% ncol()
```


#### 3. Как просмотреть примерный вид датафрейма?

```{r}
starwars %>% glimpse()
```

**Вывод:**

![](img/2.png){width="618"}

#### 4. Сколько уникальных рас персонажей (species) представлено в данных?

```{r}
starwars["species"] %>% unique() %>% nrow() 
```

#### 5. Найти самого высокого персонажа

```{r}
starwars %>% filter(height == max(height, na.rm = TRUE)) %>% 
    select(name, height, species)
```


#### 6. Найти всех персонажей ниже 170

```{r}
starwars %>% filter(height < 170) %>% select(name, height)
```


#### 7. Подсчитать ИМТ (индекс массы тела) для всех персонажей. ИМТ подсчитать по формуле

```{r}
starwars <- starwars %>% mutate(IMT = mass / ( (height / 100) ^ 2 ))
starwars 
```

#### 8. Найти 10 самых “вытянутых” персонажей. “Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей

```{r}
top10_stretched <- starwars %>%
  mutate(stretch = mass / (height / 100)) %>% 
  filter(is.finite(stretch)) %>% 
  arrange(desc(stretch)) %>%
  select(name, species, height, mass, stretch) %>%
  slice_head(n = 10)

top10_stretched
```

#### 9. Найти средний возраст персонажей каждой расы вселенной Звездных войн.

```{r}
starwars %>%
  filter(!is.na(species), !is.na(birth_year)) %>%
  group_by(species) %>%
  summarise(avg_age = mean(birth_year, na.rm = TRUE)) %>%
  arrange(desc(avg_age)) 
```


#### 10. Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.

```{r}
starwars %>%
  count(eye_color, sort = TRUE) %>%
  slice_head(n = 1) |> knitr::kable(format='markdown')
```


#### 11. Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн

```{r}
starwars %>%
  filter(!is.na(species), !is.na(name)) %>%
  mutate(name_length = nchar(name)) %>%
  group_by(species) %>%
  summarise(
    avg_name_length = round(mean(name_length), 1),
    n = n()
  ) %>%
  arrange(desc(avg_name_length)) 
```

## Оценка результатов

Задача решена с использованием языка программирования R и пакета `dplyr`. Я научился использовать эти два инструмента для анализа данных.

## Вывод

В данной работе я ответил на вопросы путем анализа и обработки датафрейма `starwars`